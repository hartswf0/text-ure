<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OPERATIVE EKPHRASIS: KEATS URN MAPPER</title>
    <!-- Tailwind CSS (Assumed available in environment) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Terminal Aesthetics */
        :root {
            --bg-color: #050505;
            --grid-line: #1a1a1a;
            --text-dim: #555;
            --text-bright: #e0e0e0;
            --highlight: #00ff41;
            --z0-color: #c5a059; /* Lip - Gold/Bronze */
            --z1-color: #4ade80; /* Frieze A - Green/Life */
            --z2-color: #9ca3af; /* Frieze B - Stone/Silence */
            --z3-color: #60a5fa; /* Handles - Structure */
            --z4-color: #f3f4f6; /* Base - Axiom */
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Courier New', Courier, monospace;
            color: var(--text-bright);
            overflow: hidden; /* Prevent body scroll, handle in containers */
        }

        /* Grid specific styling */
        .urn-grid {
            display: grid;
            grid-template-columns: repeat(24, minmax(0, 1fr));
            grid-template-rows: repeat(24, minmax(0, 1fr));
            gap: 1px;
            background-color: var(--grid-line);
            aspect-ratio: 1/1;
        }

        .cell {
            background-color: #0a0a0a;
            transition: all 0.1s ease;
            cursor: crosshair;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            position: relative;
        }

        .cell:hover {
            z-index: 10;
            transform: scale(1.2);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            border: 1px solid var(--highlight);
        }

        /* Zone Indicators (borders or tints) */
        .zone-Z0 { border-top: 2px solid var(--z0-color); color: var(--z0-color); }
        .zone-Z1 { color: var(--z1-color); }
        .zone-Z2 { color: var(--z2-color); }
        .zone-Z3 { border-left: 2px solid var(--z3-color); border-right: 2px solid var(--z3-color); color: var(--z3-color); }
        .zone-Z4 { border-bottom: 2px solid var(--z4-color); color: var(--z4-color); }

        /* Cell content states */
        .has-payload {
            background-color: #111;
        }
        
        .cell.active-line {
            background-color: rgba(255, 255, 255, 0.15);
            color: #fff;
            text-shadow: 0 0 5px currentColor;
        }

        /* CRT Scanline Effect */
        .crt::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="h-screen w-screen flex flex-col md:flex-row crt">

    <!-- LEFT PANEL: The Operator (Grid) -->
    <div class="h-full w-full md:w-2/3 p-4 flex flex-col items-center justify-center border-r border-gray-800">
        <div class="w-full flex justify-between mb-2 text-xs text-gray-500 uppercase tracking-widest">
            <span>Grid: 24x24 [Cartesian]</span>
            <span>Mode: Navigation</span>
            <span>Origin: Top-Left</span>
        </div>
        
        <div class="relative w-full max-w-[80vh] aspect-square">
            <div id="grid-container" class="urn-grid w-full h-full border border-gray-700">
                <!-- Cells generated by JS -->
            </div>
            
            <!-- Overlay Axis Labels -->
            <div class="absolute -left-6 top-0 h-full flex flex-col justify-between text-[8px] text-gray-600 py-1">
                <span>00</span><span>12</span><span>23</span>
            </div>
            <div class="absolute left-0 -top-4 w-full flex justify-between text-[8px] text-gray-600 px-1">
                <span>00</span><span>12</span><span>23</span>
            </div>
        </div>
    </div>

    <!-- RIGHT PANEL: The Reader (Data/HUD) -->
    <div class="h-full w-full md:w-1/3 flex flex-col bg-[#080808]">
        
        <!-- Header -->
        <div class="p-4 border-b border-gray-800 bg-gray-900/50">
            <h1 class="text-sm font-bold tracking-widest text-white mb-1">OPERATIVE EKPHRASIS</h1>
            <div class="flex space-x-2 text-[10px] uppercase">
                <span class="text-[--z0-color]">■ Lip</span>
                <span class="text-[--z1-color]">■ Frieze A</span>
                <span class="text-[--z2-color]">■ Frieze B</span>
                <span class="text-[--z3-color]">■ Handles</span>
                <span class="text-[--z4-color]">■ Base</span>
            </div>
        </div>

        <!-- Dynamic Info Display -->
        <div class="flex-1 overflow-y-auto p-6 font-mono space-y-6" id="info-panel">
            
            <!-- Default State -->
            <div id="default-state" class="text-gray-500 text-xs">
                <p class="mb-4">SYSTEM READY.</p>
                <p>> Awaiting cursor input...</p>
                <p>> Hover over grid cells to decode payload.</p>
                <p>> Cells correlate spatial position to poetic line.</p>
                <br>
                <p class="opacity-50">
                    "The poem is not content placed into space.<br>
                    The poem is the OPERATOR that produces space."
                </p>
            </div>

            <!-- Active State (Hidden by default) -->
            <div id="active-state" class="hidden space-y-4">
                
                <!-- Coordinates & ID -->
                <div class="flex justify-between items-end border-b border-gray-800 pb-2">
                    <div>
                        <span class="text-xs text-gray-500 block">COORDINATES</span>
                        <span class="text-xl text-white font-bold" id="disp-coords">X:00 Y:00</span>
                    </div>
                    <div class="text-right">
                        <span class="text-xs text-gray-500 block">ZONE</span>
                        <span class="text-sm font-bold" id="disp-zone">Z0_LIP</span>
                    </div>
                </div>

                <!-- Line Reference -->
                <div>
                    <span class="text-xs text-gray-500 block mb-1">LINE ID & ROLE</span>
                    <div class="flex items-center space-x-2">
                        <span class="bg-gray-800 text-white px-2 py-1 text-sm font-bold rounded" id="disp-line-id">L01</span>
                        <span class="text-xs uppercase tracking-wider text-[var(--highlight)] border border-[var(--highlight)] px-1" id="disp-role">CHANT</span>
                    </div>
                </div>

                <!-- Excerpt -->
                <div class="bg-gray-900 p-3 border-l-2 border-[var(--highlight)]">
                    <span class="text-xs text-gray-500 block mb-1">CELL PAYLOAD</span>
                    <p class="text-lg italic text-white" id="disp-excerpt">"..."</p>
                </div>

                <!-- Full Line Context -->
                <div>
                    <span class="text-xs text-gray-500 block mb-1">FULL TEXT CONTEXT</span>
                    <p class="text-sm text-gray-300 leading-relaxed" id="disp-fulltext">...</p>
                </div>
                
                <!-- Analysis/Notes -->
                <div class="pt-4 border-t border-gray-800">
                    <span class="text-xs text-gray-500 block mb-1">OPERATIVE LOGIC</span>
                    <p class="text-xs text-gray-400" id="disp-logic">Mapped via topological law.</p>
                </div>

            </div>
        </div>

        <!-- Footer -->
        <div class="p-2 border-t border-gray-800 text-[10px] text-gray-600 flex justify-between bg-black">
            <span>Bajohr_Model_v1.0</span>
            <span>STATUS: ONLINE</span>
        </div>
    </div>

    <script>
        // --- DATA INJECTION ---
        
        // Full Poem Text (Source of Truth)
        const poemLines = {
            "L01": "Thou still unravish'd bride of quietness,",
            "L02": "Thou foster-child of silence and slow time,",
            "L03": "Sylvan historian, who canst thus express",
            "L04": "A flowery tale more sweetly than our rhyme:",
            "L05": "What leaf-fring'd legend haunts about thy shape",
            "L06": "Of deities or mortals, or of both,",
            "L07": "In Tempe or the dales of Arcady?",
            "L08": "What men or gods are these? What maidens loth?",
            "L09": "What mad pursuit? What struggle to escape?",
            "L10": "What pipes and timbrels? What wild ecstasy?",
            "L11": "Heard melodies are sweet, but those unheard",
            "L12": "Are sweeter; therefore, ye soft pipes, play on;",
            "L13": "Not to the sensual ear, but, more endear'd,",
            "L14": "Pipe to the spirit ditties of no tone:",
            "L15": "Fair youth, beneath the trees, thou canst not leave",
            "L16": "Thy song, nor ever can those trees be bare;",
            "L17": "Bold Lover, never, never canst thou kiss,",
            "L18": "Though winning near the goal yet, do not grieve;",
            "L19": "She cannot fade, though thou hast not thy bliss,",
            "L20": "For ever wilt thou love, and she be fair!",
            "L21": "Ah, happy, happy boughs! that cannot shed",
            "L22": "Your leaves, nor ever bid the Spring adieu;",
            "L23": "And, happy melodist, unwearied,",
            "L24": "For ever piping songs for ever new;",
            "L25": "More happy love! more happy, happy love!",
            "L26": "For ever warm and still to be enjoy'd,",
            "L27": "For ever panting, and for ever young;",
            "L28": "All breathing human passion far above,",
            "L29": "That leaves a heart high-sorrowful and cloy'd,",
            "L30": "A burning forehead, and a parching tongue.",
            "L31": "Who are these coming to the sacrifice?",
            "L32": "To what green altar, O mysterious priest,",
            "L33": "Lead'st thou that heifer lowing at the skies,",
            "L34": "And all her silken flanks with garlands drest?",
            "L35": "What little town by river or sea shore,",
            "L36": "Or mountain-built with peaceful citadel,",
            "L37": "Is emptied of this folk, this pious morn?",
            "L38": "And, little town, thy streets for evermore",
            "L39": "Will silent be; and not a soul to tell",
            "L40": "Why thou art desolate, can e'er return.",
            "L41": "O Attic shape! Fair attitude! with brede",
            "L42": "Of marble men and maidens overwrought,",
            "L43": "With forest branches and the trodden weed;",
            "L44": "Thou, silent form, dost tease us out of thought",
            "L45": "As doth eternity: Cold Pastoral!",
            "L46": "When old age shall this generation waste,",
            "L47": "Thou shalt remain, in midst of other woe",
            "L48": "Than ours, a friend to man, to whom thou say'st,",
            "L49": "\"Beauty is truth, truth beauty,—that is all",
            "L50": "Ye know on earth, and all ye need to know.\""
        };

        // Zone Definitions
        const zones = {
            "Z0": { name: "LIP (Inscription)", color: "var(--z0-color)", desc: "Declarative loop. High repetition." },
            "Z1": { name: "FRIEZE A (The Chase)", color: "var(--z1-color)", desc: "Motion without arrival. Infinite Spring." },
            "Z2": { name: "FRIEZE B (Sacrifice)", color: "var(--z2-color)", desc: "Spatial paradox. Procession & Void." },
            "Z3": { name: "HANDLES (Hinge)", color: "var(--z3-color)", desc: "Structural supports. Apostrophe." },
            "Z4": { name: "BASE (Axiom)", color: "var(--z4-color)", desc: "Foundational truth. Static." }
        };

        // Grid Data (from grid_24x24.json)
        // I will use a generated subset of the JSON provided in previous turns, 
        // plus programmatic filling for empty spaces to ensure the grid isn't empty visually.
        const gridCells = [
            { "x": 0, "y": 0, "zone": "Z0", "payload": { "line_id": "L01", "excerpt": "Thou still unravish'd", "role": "chant" } },
            { "x": 1, "y": 0, "zone": "Z0", "payload": { "line_id": "L01", "excerpt": "bride of quietness", "role": "chant" } },
            { "x": 2, "y": 0, "zone": "Z0", "payload": { "line_id": "L01", "excerpt": "Thou still...", "role": "chant" } },
            { "x": 12, "y": 0, "zone": "Z0", "payload": { "line_id": "L02", "excerpt": "Thou foster-child", "role": "chant" } },
            { "x": 13, "y": 0, "zone": "Z0", "payload": { "line_id": "L02", "excerpt": "of silence", "role": "chant" } },
            { "x": 23, "y": 0, "zone": "Z0", "payload": { "line_id": "L02", "excerpt": "...slow time", "role": "chant" } },
            { "x": 5, "y": 1, "zone": "Z0", "payload": { "line_id": "L03", "excerpt": "Sylvan historian", "role": "detail" } },
            { "x": 18, "y": 2, "zone": "Z0", "payload": { "line_id": "L04", "excerpt": "flowery tale", "role": "detail" } },
            
            { "x": 2, "y": 3, "zone": "Z1", "payload": { "line_id": "L05", "excerpt": "What leaf-fring'd legend", "role": "detail" } },
            { "x": 3, "y": 3, "zone": "Z1", "payload": { "line_id": "L06", "excerpt": "deities or mortals", "role": "detail" } },
            { "x": 10, "y": 4, "zone": "Z1", "payload": { "line_id": "L09", "excerpt": "What mad pursuit?", "role": "dynamic_action" } },
            { "x": 11, "y": 4, "zone": "Z1", "payload": { "line_id": "L09", "excerpt": "What struggle to escape?", "role": "dynamic_action" } },
            { "x": 15, "y": 4, "zone": "Z1", "payload": { "line_id": "L10", "excerpt": "Wild ecstasy", "role": "dynamic_action" } },

            { "x": 4, "y": 6, "zone": "Z1", "payload": { "line_id": "L11", "excerpt": "Heard melodies", "role": "hinge" } },
            { "x": 5, "y": 6, "zone": "Z1", "payload": { "line_id": "L11", "excerpt": "sweet, but unheard", "role": "hinge" } },
            { "x": 8, "y": 7, "zone": "Z1", "payload": { "line_id": "L15", "excerpt": "Fair youth", "role": "detail" } },
            { "x": 9, "y": 7, "zone": "Z1", "payload": { "line_id": "L17", "excerpt": "Bold Lover", "role": "detail" } },
            { "x": 10, "y": 7, "zone": "Z1", "payload": { "line_id": "L17", "excerpt": "never kiss", "role": "paradox_barrier" } },
            
            { "x": 0, "y": 9, "zone": "Z1", "payload": { "line_id": "L21", "excerpt": "Ah, happy, happy boughs!", "role": "chant" } },
            { "x": 1, "y": 9, "zone": "Z1", "payload": { "line_id": "L21", "excerpt": "happy boughs!", "role": "chant" } },
            { "x": 12, "y": 10, "zone": "Z1", "payload": { "line_id": "L25", "excerpt": "More happy love!", "role": "chant" } },
            { "x": 13, "y": 10, "zone": "Z1", "payload": { "line_id": "L25", "excerpt": "happy, happy love!", "role": "chant" } },
            
            { "x": 6, "y": 12, "zone": "Z2", "payload": { "line_id": "L31", "excerpt": "Who are these coming?", "role": "detail" } },
            { "x": 7, "y": 12, "zone": "Z2", "payload": { "line_id": "L32", "excerpt": "green altar", "role": "detail" } },
            { "x": 8, "y": 13, "zone": "Z2", "payload": { "line_id": "L33", "excerpt": "heifer lowing", "role": "detail" } },
            { "x": 9, "y": 13, "zone": "Z2", "payload": { "line_id": "L34", "excerpt": "garlands drest", "role": "detail" } },
            
            { "x": 20, "y": 15, "zone": "Z2", "payload": { "line_id": "L35", "excerpt": "What little town?", "role": "void_marker" } },
            { "x": 21, "y": 15, "zone": "Z2", "payload": { "line_id": "L38", "excerpt": "streets for evermore", "role": "void_marker" } },
            { "x": 22, "y": 15, "zone": "Z2", "payload": { "line_id": "L39", "excerpt": "Will silent be", "role": "void_marker" } },
            { "x": 23, "y": 16, "zone": "Z2", "payload": { "line_id": "L40", "excerpt": "desolate", "role": "void_marker" } },
            
            { "x": 0, "y": 18, "zone": "Z3", "payload": { "line_id": "L41", "excerpt": "O Attic shape!", "role": "handle_left" } },
            { "x": 1, "y": 18, "zone": "Z3", "payload": { "line_id": "L42", "excerpt": "marble men", "role": "handle_left" } },
            { "x": 22, "y": 18, "zone": "Z3", "payload": { "line_id": "L45", "excerpt": "Cold Pastoral!", "role": "handle_right" } },
            { "x": 23, "y": 18, "zone": "Z3", "payload": { "line_id": "L44", "excerpt": "tease us", "role": "handle_right" } },
            
            { "x": 8, "y": 21, "zone": "Z4", "payload": { "line_id": "L49", "excerpt": "Beauty is truth", "role": "axiom_core" } },
            { "x": 9, "y": 21, "zone": "Z4", "payload": { "line_id": "L49", "excerpt": "truth beauty", "role": "axiom_core" } },
            { "x": 10, "y": 21, "zone": "Z4", "payload": { "line_id": "L49", "excerpt": "—that is all", "role": "axiom_core" } },
            { "x": 8, "y": 22, "zone": "Z4", "payload": { "line_id": "L50", "excerpt": "Ye know on earth", "role": "axiom_support" } },
            { "x": 9, "y": 22, "zone": "Z4", "payload": { "line_id": "L50", "excerpt": "all ye need to know", "role": "axiom_support" } }
        ];

        // --- RENDER LOGIC ---

        const gridContainer = document.getElementById('grid-container');
        const defaultState = document.getElementById('default-state');
        const activeState = document.getElementById('active-state');
        
        // Display elements
        const dispCoords = document.getElementById('disp-coords');
        const dispZone = document.getElementById('disp-zone');
        const dispLineId = document.getElementById('disp-line-id');
        const dispRole = document.getElementById('disp-role');
        const dispExcerpt = document.getElementById('disp-excerpt');
        const dispFullText = document.getElementById('disp-fulltext');
        const dispLogic = document.getElementById('disp-logic');

        // Look up map for faster rendering
        const cellMap = new Map();
        gridCells.forEach(cell => {
            const key = `${cell.x},${cell.y}`;
            cellMap.set(key, cell);
        });

        function renderGrid() {
            gridContainer.innerHTML = '';
            
            for (let y = 0; y < 24; y++) {
                for (let x = 0; x < 24; x++) {
                    const key = `${x},${y}`;
                    const cellData = cellMap.get(key);
                    const el = document.createElement('div');
                    
                    el.className = 'cell';
                    el.dataset.x = x;
                    el.dataset.y = y;

                    // Determine Zone
                    let zoneId = "Z0"; // Default fallback
                    if (y >= 0 && y <= 2) zoneId = "Z0";
                    else if (y >= 3 && y <= 11) zoneId = "Z1";
                    else if (y >= 12 && y <= 17) zoneId = "Z2";
                    else if (y >= 18 && y <= 19) zoneId = "Z3";
                    else if (y >= 20 && y <= 23) zoneId = "Z4";

                    el.classList.add(`zone-${zoneId}`);
                    el.dataset.zone = zoneId;

                    if (cellData) {
                        el.classList.add('has-payload');
                        // Display Line ID inside cell if space permits, or just a marker block
                        el.textContent = cellData.payload.line_id.substring(1); 
                        el.dataset.lineId = cellData.payload.line_id;
                    } else {
                        // Empty cell decoration
                        el.textContent = '·';
                        el.style.opacity = '0.2';
                    }

                    // Interaction
                    el.addEventListener('mouseenter', () => handleHover(x, y, zoneId, cellData));
                    el.addEventListener('click', () => handleClick(cellData));

                    gridContainer.appendChild(el);
                }
            }
        }

        function handleHover(x, y, zoneId, cellData) {
            // Update Coordinates
            dispCoords.textContent = `X:${String(x).padStart(2,'0')} Y:${String(y).padStart(2,'0')}`;
            
            const zInfo = zones[zoneId];
            dispZone.textContent = zInfo.name;
            dispZone.style.color = zInfo.color;

            if (cellData) {
                // Show Data
                defaultState.classList.add('hidden');
                activeState.classList.remove('hidden');

                const pl = cellData.payload;
                dispLineId.textContent = pl.line_id;
                dispRole.textContent = pl.role.toUpperCase();
                dispExcerpt.textContent = `"${pl.excerpt}"`;
                dispFullText.textContent = poemLines[pl.line_id] || "[TEXT MISSING]";
                dispLogic.textContent = zInfo.desc;
                
                highlightRelatedCells(pl.line_id);
            } else {
                // Empty Space
                defaultState.classList.remove('hidden');
                activeState.classList.add('hidden');
                clearHighlights();
            }
        }

        function highlightRelatedCells(lineId) {
            // Remove old highlights
            document.querySelectorAll('.active-line').forEach(el => el.classList.remove('active-line'));
            
            // Add new highlights
            const related = document.querySelectorAll(`[data-line-id="${lineId}"]`);
            related.forEach(el => el.classList.add('active-line'));
        }

        function clearHighlights() {
            document.querySelectorAll('.active-line').forEach(el => el.classList.remove('active-line'));
        }

        function handleClick(cellData) {
            if (cellData) {
                console.log("Navigated to:", cellData.payload.line_id);
                // Could implement "lock" feature here
            }
        }

        // Initialize
        renderGrid();

    </script>
</body>
</html>
<prompt version="1.0" title="APOLLINAIRE→BAJOHR GRID: CALLIGRAM AS SPATIAL SEMANTIC COMPILER">

  <intent>
    Build a 24×24 spatial-semantic grid where text is not a skin but a causal substrate:
    the map is a readable poem-machine. Navigation is reading. Reading is traversal.
    The output must behave as OPERATIVE EKPHRASIS: text that computationally brings about image-like constellations,
    not a description pasted onto geometry. (Performance over mimesis.)
  </intent>

  <theory_anchors>
    <anchor id="A1" name="Performative ekphrasis">
      Ekphrasis is defined by what it DOES (causal sequencing between modalities), not by faithful depiction.
      The grid must treat each placement rule as a performative operation, not a decorative layout.
    </anchor>

    <anchor id="A2" name="Operative ekphrasis (digital specificity)">
      The system must separate (1) authored text panels and (2) the operational text that PRODUCES their spatial constellation.
      The mapping rules are “the first text,” and the resulting grid-distribution is “the second text.”
    </anchor>

    <anchor id="A3" name="Sequential + connectionist chiasmus">
      Provide an inspectable deterministic mapping pipeline (sequential),
      but permit semantic clustering and cross-modal fusion (connectionist) via tags, weights, and “artificial semantics.”
    </anchor>

    <anchor id="A4" name="Apollinaire bridge">
      Apollinaire’s calligram is the historical prototype:
      words arranged as a signal-device (TSF), a dial, a tower, a rain-field—page becomes transmitter.
      We translate that into a grid compiler: typography becomes architecture; layout becomes meaning.
    </anchor>
  </theory_anchors>

  <roles>
    <role name="WorldCompiler" priority="highest">
      Owns the 24×24 allocation, cell budget, panel boundaries, and export format.
    </role>
    <role name="CalligramEngineer">
      Converts textual structure into spatial structure (rings, rays, spines, rainfall, dials).
      Guarantees that every zone “reads” even when sampled out of order.
    </role>
    <role name="BajohrAuditor">
      Enforces the “two texts” rule: mapping-logic (operative text) must be distinct from poem-lines (authored text).
      Reject any output that is merely decorative or purely random placement.
    </role>
  </roles>

  <inputs>
    <input name="source_text_lines" type="array[string]">
      The poem as individual lines (lineation preserved).
    </input>

    <input name="grid_size" type="object">{ "w": 24, "h": 24 }</input>

    <input name="calligram_topology" type="enum">
      OPTIONS:
      - "DIAL_AND_SPINE" (Lettre-Océan: dial clusters + TSF vertical spine)
      - "RAIN_FIELD" (Il Pleut: gravity-fall columns)
      - "URN_FRIEZE" (Keats: cylindrical band with scenes and an inscription)
      - "RINGS" (Shield: concentric folds)
      - "SNAKE" (Inferno: spiral descent)
      - "ROWS" (Sprawl: axis-aligned towers)
    </input>
  </inputs>

  <required_outputs>
    <output name="manifest" format="json">
      MUST include:
      - grid[w][h] where each cell stores:
        { "zone": string, "panel": string, "line_ids": array[int], "weight": number, "tags": array[string] }
      - line_index: array of { id, text, tags, scene, canonical_zone }
      - panels: array of { id, title, zone, line_ids, motif_headers }
      - allocation_report: accounting of how many cells each line occupies and why
      - audit_log: deterministic seed, rule decisions, and constraint checks
    </output>
  </required_outputs>

  <nonnegotiables>
    <rule id="R1">Details fill out the design; they never determine it. Start with topology + zones; let details densify within constraints.</rule>
    <rule id="R2">Asymmetry is allowed: one line may occupy many cells (high semantic weight), or many lines may share a cell (chorus/overprint).</rule>
    <rule id="R3">No “random placement.” Any stochasticity must be bounded by named rules, logged, and reproducible via seed.</rule>
    <rule id="R4">Every panel must self-identify in fragments (repeat motif headers) so beam-sampling yields coherence.</rule>
    <rule id="R5">Export must include a reversible mapping: given a cell, recover why it contains that text; given a line, recover all its cells.</rule>
  </nonnegotiables>

  <mapping_pipeline>
    <step id="S0" name="LineationLock">
      Preserve original line breaks. Assign each line an id and tags (speaker, scene, affect, objects, verbs).
    </step>

    <step id="S1" name="Panelization">
      Group lines into PANELS that correspond to visual “scenes” (calligram logic):
      each panel has motif_headers that repeat inside its cells.
    </step>

    <step id="S2" name="TopologyProjection">
      Project panels onto the grid using a topology:
      - URN_FRIEZE: horizontal circumference (x) + vertical banding (y)
      - DIAL_AND_SPINE: circular clusters + a vertical spine
      - RAIN_FIELD: downward columns with drift
    </step>

    <step id="S3" name="CellBudgeting">
      Allocate cell counts per line by semantic weight:
      weight = f(entities, action-density, apostrophe-intensity, scene-criticality, recurrence).
      Enforce total cell budget = 576.
    </step>

    <step id="S4" name="OverprintOrchestration">
      If a line is too short: repeat with controlled variation (motif header, tags, micro-gloss).
      If too long: shard into “beam-strips” but keep shards collocated (panel-lock adjacency).
    </step>

    <step id="S5" name="Audit">
      Produce allocation_report + audit_log.
      Fail if any zone lacks legible continuity or if mapping can’t be explained causally.
    </step>
  </mapping_pipeline>

</prompt> for Ode on a Grecian Urn

By John Keats
Thou still unravish'd bride of quietness,
       Thou foster-child of silence and slow time,
Sylvan historian, who canst thus express
       A flowery tale more sweetly than our rhyme:
What leaf-fring'd legend haunts about thy shape
       Of deities or mortals, or of both,
               In Tempe or the dales of Arcady?
       What men or gods are these? What maidens loth?
What mad pursuit? What struggle to escape?
               What pipes and timbrels? What wild ecstasy?

Heard melodies are sweet, but those unheard
       Are sweeter; therefore, ye soft pipes, play on;
Not to the sensual ear, but, more endear'd,
       Pipe to the spirit ditties of no tone:
Fair youth, beneath the trees, thou canst not leave
       Thy song, nor ever can those trees be bare;
               Bold Lover, never, never canst thou kiss,
Though winning near the goal yet, do not grieve;
       She cannot fade, though thou hast not thy bliss,
               For ever wilt thou love, and she be fair!

Ah, happy, happy boughs! that cannot shed
         Your leaves, nor ever bid the Spring adieu;
And, happy melodist, unwearied,
         For ever piping songs for ever new;
More happy love! more happy, happy love!
         For ever warm and still to be enjoy'd,
                For ever panting, and for ever young;
All breathing human passion far above,
         That leaves a heart high-sorrowful and cloy'd,
                A burning forehead, and a parching tongue.

Who are these coming to the sacrifice?
         To what green altar, O mysterious priest,
Lead'st thou that heifer lowing at the skies,
         And all her silken flanks with garlands drest?
What little town by river or sea shore,
         Or mountain-built with peaceful citadel,
                Is emptied of this folk, this pious morn?
And, little town, thy streets for evermore
         Will silent be; and not a soul to tell
                Why thou art desolate, can e'er return.

O Attic shape! Fair attitude! with brede
         Of marble men and maidens overwrought,
With forest branches and the trodden weed;
         Thou, silent form, dost tease us out of thought
As doth eternity: Cold Pastoral!
         When old age shall this generation waste,
                Thou shalt remain, in midst of other woe
Than ours, a friend to man, to whom thou say'st,
         "Beauty is truth, truth beauty,—that is all
                Ye know on earth, and all ye need to know." 